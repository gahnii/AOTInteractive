<!doctype html><html lang="en"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>104th Cadet Evaluation</title>
<style>
:root{--ink:#1f2b2a;--accent:#6b1f1f;--mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace}
*{box-sizing:border-box}html,body{height:100%}
body{margin:0;overflow:hidden;color:var(--ink);font-family:var(--mono)}
.bg{position:fixed;inset:0;background:url("parchment.jpg") center/cover no-repeat}
.bg:after{content:"";position:absolute;inset:0;background:radial-gradient(900px 520px at 50% 45%,transparent 55%,rgba(0,0,0,.22)),radial-gradient(1200px 900px at 50% 50%,transparent 60%,rgba(0,0,0,.18));opacity:.35}

.blood{position:fixed;inset:0;pointer-events:none;opacity:0;transition:opacity .7s ease}
.blood img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:saturate(1.2) contrast(1.05)}
.vignette{position:fixed;inset:0;pointer-events:none;opacity:0;transition:opacity .7s ease;background:radial-gradient(800px 520px at 50% 45%,transparent 55%,rgba(0,0,0,.55),rgba(0,0,0,.78))}

.top{position:fixed;left:0;right:0;top:0;display:flex;justify-content:space-between;gap:12px;padding:18px 28px;pointer-events:none}
.h1{font-weight:800;letter-spacing:.6px;text-transform:uppercase;font-size:18px}
.sub{opacity:.75;font-size:12px;margin-top:6px}
.stamp{font-size:12px;text-align:right;border:1px dashed rgba(0,0,0,.28);border-radius:10px;padding:10px 12px;background:rgba(255,255,255,.18)}
.stamp b{color:var(--accent)}

.wrap{position:relative;height:100%;display:grid;align-items:center;padding:90px 28px 190px}
.text{max-width:920px;font-size:16px;line-height:1.95;margin:0 auto}
.caret{display:inline-block;width:9px;height:18px;vertical-align:-3px;margin-left:4px;background:rgba(31,43,42,.65);animation:blink 1.1s steps(1) infinite}
@keyframes blink{50%{opacity:0}}
.hint{font-size:12px;opacity:.65;margin-top:10px}

/* footer -> always centered bottom middle */
.bottom{
  position:fixed;left:50%;transform:translateX(-50%);
  bottom:0;
  width:min(920px,92vw);
  padding:18px 0 22px;
  display:grid;
  gap:12px;
  justify-items:stretch;
}

.box{
  border:1px solid rgba(0,0,0,.22);
  border-radius:10px;
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(2px);
  padding:12px 14px
}
.label{opacity:.8;font-size:12px;margin-bottom:8px;text-transform:uppercase;letter-spacing:.4px;display:flex;justify-content:space-between;gap:12px}
.pill{border:1px solid rgba(0,0,0,.18);border-radius:999px;padding:2px 8px;font-size:11px;opacity:.75}
.row{display:flex;gap:10px;align-items:center}
input{flex:1;font:16px var(--mono);border:0;outline:0;background:transparent;color:var(--ink)}
.btn{font:12px var(--mono);text-transform:uppercase;padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,.22);background:rgba(255,255,255,.18);cursor:pointer}
.btn:disabled{opacity:.45;cursor:not-allowed}
.hidden{display:none}

#out .ln{display:block;white-space:pre-wrap}
#out .dim{opacity:.35}
#out .fade{opacity:.18}
#out .who{font-weight:900}
#out .pick{color:var(--accent);font-weight:800}

.choices{display:grid;grid-template-columns:1fr;gap:10px}
.choice{text-align:left}

@media (prefers-reduced-motion:reduce){
  .caret{animation:none}
  .blood,.vignette{transition:none}
}
</style></head><body>
<div class="bg"></div>

<div class="blood" id="blood"><img src="blood.png" alt=""></div>
<div class="vignette" id="vignette"></div>

<header class="top">
  <div>
    <div class="h1">104th Cadet Corps — Evaluation Program</div>
    <div class="sub">Recruitment &amp; Aptitude Intake • Phase <span id="phaseNum">1</span></div>
  </div>
  <div class="stamp">FILE: <b>#104-INTAKE</b><br>STATUS: <b id="status">RECORDING</b></div>
</header>

<main class="wrap">
  <div class="text">
    <span id="out"></span><span class="caret"></span>
    <div class="hint" id="hint">click / space / enter to begin</div>
  </div>
</main>

<footer class="bottom">
  <div class="box hidden" id="boxStatus">
    <div class="label"><span id="statusTitle">status</span><span class="pill" id="statusPill">locked</span></div>
    <div id="statusText" style="font-size:14px;opacity:.9;line-height:1.6"></div>
  </div>

  <div class="box hidden" id="boxText">
    <div class="label"><span id="prompt">your response</span><span class="pill" id="mode">locked</span></div>
    <div class="row">
      <input id="inp" maxlength="80" autocomplete="off" disabled>
      <button class="btn" id="send" disabled>send</button>
    </div>
  </div>

  <div class="box hidden" id="boxChoice">
    <div class="label"><span id="choiceTitle">action</span><span class="pill" id="choiceMode">phase 2</span></div>
    <div class="choices" id="choices"></div>
  </div>
</footer>

<script>
const $=id=>document.getElementById(id);
const out=$("out"),hint=$("hint"),phaseNum=$("phaseNum"),statusEl=$("status");
const boxText=$("boxText"),prompt=$("prompt"),mode=$("mode"),inp=$("inp"),send=$("send");
const boxChoice=$("boxChoice"),choiceTitle=$("choiceTitle"),choiceMode=$("choiceMode"),choicesEl=$("choices");
const blood=$("blood"),vignette=$("vignette");
const boxStatus=$("boxStatus"),statusTitle=$("statusTitle"),statusPill=$("statusPill"),statusText=$("statusText");

const intro=[{t:"Starting..",g:900},{t:"",g:450},{t:"104th Cadet Corps Evaluation Program.",g:900},{t:"",g:450},{t:"This session is recorded.",g:700},{t:"Respond clearly.",g:900},{t:"",g:450},{t:"Hesitation will be noted.",g:1100},{t:"",g:450},{t:"State your name.",g:700}];

let started=0,q=Promise.resolve(),locked=false,sceneId=null;
let state={phase:1,name:localStorage.getItem("aot_cadet_name")||"",fear:0,hesitation:0,obedience:0,initiative:0,injuries:0,dead:false};

const wait=ms=>new Promise(r=>setTimeout(r,ms)), rand=(a,b)=>a+Math.random()*(b-a);
const CM=55,CX=120, clamp=(n,a,b)=>Math.max(a,Math.min(b,n));
const enqueue=fn=>(q=q.then(fn).catch(()=>{}));

/* ------- AUDIO (typing + subbass) ------- */
let AC=null, typeBuf=null, subBuf=null, master=null, lastTick=0;
let subSrc=null, subGain=null, subLP=null, subComp=null;

async function initAudio(){
  if(AC) return;
  AC=new (window.AudioContext||window.webkitAudioContext)();
  master=AC.createGain(); master.gain.value=1.25; master.connect(AC.destination);

  const load=async(url)=>AC.decodeAudioData(await (await fetch(url)).arrayBuffer());
  [typeBuf, subBuf]=await Promise.all([load("type.mp3"), load("subbass.mp3")]);

  subGain=AC.createGain();
  subLP=AC.createBiquadFilter(); subLP.type="lowpass"; subLP.frequency.value=14000; subLP.Q.value=.7;
  subComp=AC.createDynamicsCompressor();
  subComp.threshold.value=-24; subComp.knee.value=30; subComp.ratio.value=6; subComp.attack.value=.01; subComp.release.value=.2;

  subGain.connect(subLP); subLP.connect(subComp); subComp.connect(master);
}

function tick(){
  if(!AC||!typeBuf) return;
  const t=AC.currentTime; if(t-lastTick<.03) return; lastTick=t;
  const src=AC.createBufferSource(); src.buffer=typeBuf;
  const len=.055, st=Math.max(0,Math.random()*(typeBuf.duration-len-.02));
  const g=AC.createGain();
  g.gain.setValueAtTime(0,t);
  g.gain.linearRampToValueAtTime(.85,t+.006);
  g.gain.linearRampToValueAtTime(0,t+len);
  src.connect(g); g.connect(master);
  src.start(t,st,len);
}

function startSubbass(){
  if(!AC||!subBuf||subSrc) return;
  subSrc=AC.createBufferSource(); subSrc.buffer=subBuf; subSrc.loop=true;
  subGain.gain.value=0;
  subSrc.connect(subGain);
  subSrc.start();
}
function stopSubbass(fadeMs=500){
  if(!AC||!subSrc) return;
  const t=AC.currentTime;
  subGain.gain.cancelScheduledValues(t);
  subGain.gain.setValueAtTime(subGain.gain.value,t);
  subGain.gain.linearRampToValueAtTime(0,t+fadeMs/1000);
  const kill=subSrc; subSrc=null;
  setTimeout(()=>{ try{kill.stop();}catch{} }, fadeMs+50);
}

function setSubbassIntensity(x, ms=200){
  if(!AC||!subGain||!subLP) return;
  x=clamp(x,0,1);
  const t=AC.currentTime, d=ms/1000;
  const gain = 0.18 + 0.55*x;
  const cutoff = 14000 - 12000*x;
  const q = 0.7 + 2.2*x;

  subGain.gain.cancelScheduledValues(t);
  subGain.gain.setValueAtTime(subGain.gain.value,t);
  subGain.gain.linearRampToValueAtTime(gain,t+d);

  subLP.frequency.cancelScheduledValues(t);
  subLP.frequency.setValueAtTime(subLP.frequency.value,t);
  subLP.frequency.linearRampToValueAtTime(cutoff,t+d);

  subLP.Q.cancelScheduledValues(t);
  subLP.Q.setValueAtTime(subLP.Q.value,t);
  subLP.Q.linearRampToValueAtTime(q,t+d);
}

/* ------- OUTPUT ------- */
const KEEP=9,DIM=2; let lines=[],cur="";
const WHO0="\uE020",WHO1="\uE021",P0="\uE010",P1="\uE011";
const W=t=>`${WHO0}INSTRUCTOR ENZO:${WHO1} ${t}`, PICK=t=>`${P0}${t}${P1}`;
const esc=s=>String(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
const markup=s=>esc(s).replaceAll(WHO0,'<span class="who">').replaceAll(WHO1,"</span>").replaceAll(P0,'<span class="pick">').replaceAll(P1,"</span>");

function render(){
  const n=lines.length, start=Math.max(0,n-(KEEP+DIM));
  const view=lines.slice(start);
  out.innerHTML=view.map((l,i)=>{
    const age=view.length-1-i, cls=age>=KEEP+1?"fade":age>=KEEP?"dim":"";
    return `<span class="ln ${cls}">${markup(l)}</span>`;
  }).join("") + (cur?`<span class="ln">${markup(cur)}</span>`:"");
}
function pushLine(l){
  lines.push(l);
  const cap=KEEP+DIM+5;
  if(lines.length>cap) lines=lines.slice(lines.length-cap);
}
async function typeChars(str){
  for(let i=0;i<str.length;i++){ cur+=str[i]; tick(); render(); await wait(rand(CM,CX)); }
}
async function typeLine(str,gap=780){
  if(str===""){ pushLine(""); cur=""; render(); await wait(420); return; }
  await typeChars(str); pushLine(cur); cur=""; render(); await wait(gap);
}
async function say(arr){
  arr=Array.isArray(arr)?arr:String(arr).split("\n");
  for(const ln of arr) await typeLine(ln,650);
}

/* ------- UI ------- */
const hideAllBoxes=()=>{
  boxStatus.classList.add("hidden");
  boxText.classList.add("hidden");
  boxChoice.classList.add("hidden");
};
const showText=(label,pill)=>{
  hideAllBoxes();
  boxText.classList.remove("hidden");
  prompt.textContent=label; mode.textContent=pill;
  inp.disabled=send.disabled=false; inp.focus();
};
const lockText=pill=>{ inp.disabled=send.disabled=true; mode.textContent=pill; };
const showChoices=(title,pill)=>{
  hideAllBoxes();
  boxChoice.classList.remove("hidden");
  choiceTitle.textContent=title; choiceMode.textContent=pill;
};
const showStatus=(title,pill,text)=>{
  hideAllBoxes();
  boxStatus.classList.remove("hidden");
  statusTitle.textContent=title;
  statusPill.textContent=pill;
  statusText.textContent=text||"";
};
const setStatus=s=>statusEl.textContent=s;
const clearScreen=()=>{lines=[];cur="";render();};
const clearChoices=()=>choicesEl.innerHTML="";

/* visuals */
const setBlood=a=>{blood.style.opacity=Math.max(0,Math.min(1,a));};
const setVignette=a=>{vignette.style.opacity=Math.max(0,Math.min(1,a));};

function applyFx(fx){
  if(!fx) return;
  for(const k in fx) if(typeof state[k]==="number") state[k]+=Number(fx[k]||0);
  state.fear=clamp(state.fear,0,9); state.hesitation=clamp(state.hesitation,0,9);
}

/* “MIGHT DIE” bed */
function setRisk(on){
  if(!AC) return;
  if(on){
    startSubbass();
    setSubbassIntensity(0.35,260);
    setVignette(0.18);
  }else{
    setSubbassIntensity(0.0,300);
    setVignette(0.0);
    stopSubbass(600);
  }
}

/* ------- PHASE 2 ------- */
const SCENES={
  field_entry:{
    text:s=>[
      W("Phase 2. Field Evaluation."),
      W(`Cadet ${s.name||"—"}. You will move when told.`),
      "",
      "You step into a training field.",
      "Wind. Dry grass. A bell tower silhouette in the distance.",
      "A single Titan target moves between ruined frames. It has not seen you."
    ],
    title:"choose",
    choices:[
      {k:"A",label:"stay low. approach from debris.",fx:{obedience:+1},next:"approach_debris"},
      {k:"B",label:"sprint straight to close distance.",fx:{initiative:+1,hesitation:+1},next:"sprint_open"},
      {k:"C",label:"wait. observe its pattern.",fx:{hesitation:+1},next:"observe"}
    ]
  },

  observe:{
    text:()=>[
      "You hold your breath and watch.",
      "It walks; three steps. pause. tilt head. repeat.",
      "Your legs tense. The window closes.",
      W("Decision. Now.")
    ],
    title:"choose",
    choices:[
      {k:"1",label:"approach from debris.",fx:{obedience:+1},next:"approach_debris"},
      {k:"2",label:"sprint in.",fx:{initiative:+1,hesitation:+1},next:"sprint_open"},
      {k:"3",label:"withdraw.",fx:{hesitation:+2},next:"end_withdrawn"}
    ]
  },

  approach_debris:{
    text:()=>[
      W("Good. Use cover."),
      "You move between broken stone and splintered beams.",
      "The Titan turns its head—slow. Searching.",
      "You are within striking range."
    ],
    title:"one action",
    choices:[
      {k:"1",label:"aim for the eyes.",fx:{initiative:+1},next:"eyes_attempt"},
      {k:"2",label:"cut the achilles.",fx:{obedience:+1},next:"ankle_attempt"},
      {k:"3",label:"back off. reposition.",fx:{hesitation:+1},next:"reposition"}
    ]
  },

  sprint_open:{
    text:()=>[
      W("Loud."),
      "You break into a sprint.",
      "The Titan’s head snaps toward you.",
      "It sees you.",
      "Your stomach drops."
    ],
    title:"react",
    choices:[
      {k:"1",label:"zigzag toward its blind spot.",fx:{initiative:+1},next:"blindspot"},
      {k:"2",label:"keep charging. commit.",fx:{initiative:+2,fear:+1},next:"commit_charge"},
      {k:"3",label:"abort. dive behind rubble.",fx:{obedience:+1,hesitation:+1},next:"dive_cover"}
    ]
  },

  eyes_attempt:{
    text:()=>[
      "You angle upward.",
      "Your blade lines with the eye socket—",
      "The Titan jerks.",
      "Your timing matters."
    ],
    title:"commit",
    choices:[
      {k:"1",label:"strike.",fx:{initiative:+1},next:"eyes_strike"},
      {k:"2",label:"hesitate.",fx:{hesitation:+2,fear:+1},next:"death_slow"}
    ]
  },

  eyes_strike:{
    text:()=>[
      "Your blade lands. The Titan recoils.",
      "It thrashes blind on one side.",
      "Stone bursts beside you.",
      W("Move.")
    ],
    title:"escape",
    choices:[
      {k:"1",label:"retreat to cover.",fx:{obedience:+1},next:"end_clean"},
      {k:"2",label:"press for more.",fx:{initiative:+1,fear:+1},next:"end_messy"}
    ]
  },

  ankle_attempt:{
    text:()=>[
      "You drop low.",
      "You cut. Deep.",
      "The Titan stumbles. Not down."
    ],
    title:"follow-up",
    choices:[
      {k:"1",label:"get out now.",fx:{obedience:+1},next:"end_messy"},
      {k:"2",label:"stay. keep cutting.",fx:{initiative:+1,fear:+1},next:"death_slow"}
    ]
  },

  reposition:{
    text:()=>[
      "You pull back.",
      "The Titan’s head turns—searching for the movement it felt.",
      W("You’re bleeding time.")
    ],
    title:"choose",
    choices:[
      {k:"1",label:"re-engage.",fx:{initiative:+1},next:"eyes_attempt"},
      {k:"2",label:"withdraw fully.",fx:{hesitation:+2},next:"end_withdrawn"}
    ]
  },

  blindspot:{
    text:()=>[
      "You cut left, then right.",
      "The Titan swings late.",
      "You slip behind it.",
      W("Now.")
    ],
    title:"one action",
    choices:[
      {k:"1",label:"break away.",fx:{obedience:+1},next:"end_clean"},
      {k:"2",label:"go for the eyes.",fx:{initiative:+1},next:"end_messy"}
    ]
  },

  commit_charge:{
    text:()=>[
      "You commit.",
      "The Titan’s shadow swallows the ground.",
      "It reaches."
    ],
    title:"last chance",
    choices:[
      {k:"1",label:"duck under. pass through.",fx:{initiative:+2},next:"blindspot"},
      {k:"2",label:"jump up. gamble.",fx:{fear:+2},next:"death_slow"}
    ]
  },

  dive_cover:{
    text:()=>[
      "You dive behind rubble.",
      "Dust fills your mouth.",
      "The Titan’s fingers scrape stone.",
      "It didn’t get you."
    ],
    title:"next",
    choices:[
      {k:"1",label:"crawl away. reset.",fx:{obedience:+1},next:"approach_debris"},
      {k:"2",label:"run again.",fx:{hesitation:+1,fear:+1},next:"sprint_open"}
    ]
  },

  death_slow:{
    death:true,
    ramp:[0,.10,.18,.28,.42,.58,.72,.86,1],
    text:()=>[
      "You hesitate.","Not long.","Just long enough.","",
      "The titan grabs you.. and the air changes.","",
      "The world snaps upward.","Your stomach drops behind you.","",
      "You try to inhale.. but nothing comes in.","Panic sets in.","",
      "Your voice tears out.","It turns into a sound you don’t recognize.","",
      "The field tilts.. and the sky smears sideways.","Your vision tunnels. Your ears start ringing.","",
      "You kick, you squirm.. but it doesn't let go.","You yell to your instructor.. but no one hears.","",
      "A calm second passes—","like the world is waiting for you to stop.","",
      "Then.. silence.","",
      PICK("STATUS: DECEASED.")
    ],
    sub:"Hesitation will get you nowhere."
  },

  end_clean:{ end:true, text:()=>[
    "You disengage cleanly.","Your breathing steadies.",
    W("Adequate control. Minimal wasted motion."),
    W("Evaluation logged: PASS."),"",PICK("End of Phase 2.")
  ]},

  end_messy:{ end:true, text:()=>[
    "You disengage.","Your hands keep shaking after you stop.",
    W("You lived. That’s not the same as succeeding."),
    W("Evaluation logged: PASS (CONDITIONAL)."),"",PICK("End of Phase 2.")
  ]},

  end_withdrawn:{ end:true, text:()=>[
    "You withdraw.","The bell tower fades behind you.",
    W("Withdrawal is also a decision."),
    W("Evaluation logged: FAIL."),"",PICK("End of Phase 2.")
  ]}
};

/* choices */
function renderChoices(scene){
  clearChoices(); if(scene.death||scene.end) return;

  const hasDeath = scene.choices?.some(c => (SCENES[c.next] && SCENES[c.next].death));
  setRisk(!!hasDeath);

  showChoices(scene.title||"action","phase 2");
  scene.choices.forEach((c,idx)=>{
    const b=document.createElement("button");
    b.className="btn choice"; b.type="button";
    b.innerHTML=`<span>${c.k}. ${c.label}</span>`;
    b.onclick=()=>pick(idx);
    choicesEl.appendChild(b);
  });

  document.onkeydown=e=>{
    if(locked) return;
    const key=e.key.toUpperCase();
    const i=scene.choices.findIndex(x=>String(x.k).toUpperCase()===key);
    if(i>=0){ e.preventDefault(); pick(i); }
  };
}

/* death sync */
function applyDeathSync(i,total,ramp){
  const p = total<=1 ? 1 : i/(total-1);
  const bloodA = ramp[Math.min(i,ramp.length-1)] ?? (0.9*p);
  setBlood(bloodA);
  const intensity = clamp((p*p*1.05), 0, 1);
  setSubbassIntensity(intensity, 180);
  setVignette(0.25 + 0.55*intensity);
}

async function runDeath(scene){
  setRisk(false);
  startSubbass();
  setSubbassIntensity(0.10,120);

  setStatus("DECEASED"); state.dead=true; locked=true;
  showStatus("status","deceased", scene.sub||"Evaluation terminated.");

  const oldBT=blood.style.transition, oldVT=vignette.style.transition;
  blood.style.transition="opacity .12s linear";
  vignette.style.transition="opacity .12s linear";

  const ramp=scene.ramp||[0,.25,.5,.75,1];
  setBlood(ramp[0]??0); setVignette(.35);

  const seq=(typeof scene.text==="function"?scene.text(state):scene.text);
  for(let i=0;i<seq.length;i++){
    applyDeathSync(i, seq.length, ramp);
    await typeLine(seq[i],650);
  }

  setSubbassIntensity(0,120);
  stopSubbass(250);

  blood.style.transition=oldBT;
  vignette.style.transition=oldVT;
}

async function goto(id){
  sceneId=id; const scene=SCENES[id]; if(!scene) return;
  locked=true; clearChoices();

  if(scene.death){ await runDeath(scene); return; }

  setBlood(0); setVignette(0);
  hideAllBoxes(); // <- stops overlap during transitions

  await say(["",...(typeof scene.text==="function"?scene.text(state):scene.text)]);
  if(scene.end){ setRisk(false); locked=true; showStatus("status","logged","Evaluation complete."); return; }
  renderChoices(scene); locked=false;
}

function pick(i){
  const scene=SCENES[sceneId]; if(!scene||!scene.choices||locked) return;
  const c=scene.choices[i]; if(!c) return;
  locked=true;
  enqueue(async()=>{
    await say(["",PICK(`> ${c.k}. ${c.label}`)]);
    applyFx(c.fx);
    if(c.next) await goto(c.next);
  });
}

/* flow */
async function runIntro(){ for(const x of intro) await typeLine(x.t,x.g); showText("your response","phase 1"); }
async function enterPhase2(){
  state.phase=2; phaseNum.textContent="2"; setStatus("RECORDING");
  setBlood(0); setVignette(0); setRisk(false);
  state.dead=false; locked=false;
  clearScreen();
  await goto("field_entry");
}

function start(){
  if(started) return;
  started=1; hint.classList.add("hidden");
  document.removeEventListener("click",start); document.removeEventListener("keydown",keyStart);
  initAudio().then(()=>enqueue(runIntro));
}
function keyStart(e){ if(e.key===" "||e.key==="Enter"){ e.preventDefault(); start(); } }
document.addEventListener("click",start);
document.addEventListener("keydown",keyStart);

send.addEventListener("click",()=>{
  const v=inp.value.trim(); if(!v) return; inp.value="";
  if(state.phase===1){
    lockText("processing"); state.name=v; localStorage.setItem("aot_cadet_name",v);
    enqueue(async()=>{ await say(["","Name received: "+v,"Noted.","Profile initialized.","","Proceed when ready."]); showText("type: proceed","awaiting"); state.phase=1.5; });
    return;
  }
  if(state.phase===1.5){
    if(v.toLowerCase()!=="proceed"){ enqueue(()=>say(["","Command rejected.","Type: proceed"])); return; }
    lockText("loading"); enqueue(async()=>{ await say(["","Acknowledged.","Loading evaluation module…",""]); await enterPhase2(); });
  }
});
inp.addEventListener("keydown",e=>{ if(e.key==="Enter") send.click(); });

render();
</script>
</body></html>
